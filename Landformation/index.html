<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Landforms: Dominant Process & Agent of Formation</title>
  <style>
    /* Basic reset */
    body {
      margin: 20px;
      font-family: Arial, sans-serif;
      background-color: #fff;
    }

    h1 {
      margin-bottom: 10px;
    }

    /* Main layout: table left, banks right */
    #mainContainer {
      display: flex;
      gap: 20px;
      align-items: flex-start;
    }
    #tableContainer {
      flex: 0 0 auto;
    }

    /* Force the table to have EXACTLY 3 columns side by side. 
       table-layout: fixed => consistent column widths.
       colgroup => sets explicit widths, preventing wrapping. */
    table {
      table-layout: fixed;
      width: 800px;   /* total width for 3 columns */
      border-collapse: separate;
      border-spacing: 0;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 0 4px rgba(0,0,0,0.2);
    }
    col:nth-child(1) { width: 200px; }
    col:nth-child(2) { width: 300px; }
    col:nth-child(3) { width: 300px; }

    /* Dark orange header with white text */
    thead tr {
      background-color: #d97b00;
      color: #fff;
    }
    thead th {
      height: 36px;
      padding: 6px 8px;
      font-size: 0.9em;
      white-space: nowrap;
      text-align: center;
      vertical-align: middle;
    }

    /* Alternate row color: row1 => light (#fce0b8), row2 => dark (#d97b00) with white text, etc. */
    tbody tr:nth-child(odd) {
      background-color: #fce0b8; /* light orange */
      color: #000;
    }
    tbody tr:nth-child(even) {
      background-color: #d97b00; /* dark orange */
      color: #fff;
    }

    /* Each row has exactly 3 cells: 
       (1) Landform, (2) Dominant Process dropzone, (3) Agent dropzone. */
    th, td {
      border: none;
      text-align: center;
      vertical-align: middle;
      height: 36px;
      padding: 4px 6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 0.9em;
    }

    /* Dropzone occupies the entire cell. Only 1 occupant. */
    .dropzone {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    /* Banks on right (no border) */
    #banksContainer {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .bank h2 {
      margin: 0 0 4px;
      font-size: 1em;
      background: #eee;
      padding: 4px 6px;
      border-radius: 4px;
    }

    /* Draggables */
    .draggable {
      margin: 4px 0;
      padding: 4px 8px;
      cursor: move;
      border-radius: 6px;
      text-align: center;
      font-size: 0.9em;
      display: inline-block;
      white-space: nowrap;
    }
    .draggable:hover {
      opacity: 0.85;
    }
    /* White w/ orange border => Dominant Process */
    .process-item {
      background-color: #fff;
      border: 2px solid orange;
      color: #333;
    }
    /* Orange w/ white border => Agent */
    .agent-item {
      background-color: orange;
      border: 2px solid #fff;
      color: #fff;
    }

    /* On dragover highlight */
    .highlight {
      outline: 2px dashed #777;
    }

    /* Correct/incorrect occupant backgrounds */
    .correct {
      background-color: #c3f7c3 !important;
      color: #000 !important;
    }
    .incorrect {
      background-color: #f9c3c3 !important;
      color: #000 !important;
    }

    /* Buttons */
    .btn {
      margin-top: 12px;
      padding: 6px 12px;
      font-size: 0.9em;
      border: none;
      border-radius: 20px;
      cursor: pointer;
    }
    #checkButton {
      background-color: #007bff;
      color: #fff;
    }
    #retryButton {
      background-color: #ccc;
      color: #333;
      margin-left: 8px;
    }
    #copyButton {
      background-color: #28a745;
      color: #fff;
      margin-left: 8px;
      display: none; /* show if all correct */
    }
  </style>
</head>
<body>

<h1>Landforms: Dominant Process &amp; Agent of Formation</h1>
<p>
  <em>
    Each row is fully colored: landform on the left, 
    a single <strong>Dominant Process</strong> cell in the middle, 
    and a single <strong>Agent</strong> cell on the right.<br/>
    The “Agent” column definitely accepts drops side-by-side with the Process column.<br/>
    Only one occupant per column. Dropping a new occupant replaces the old.
  </em>
</p>

<div id="mainContainer">
  <!-- LEFT: Table Container -->
  <div id="tableContainer">
    <table id="landformsTable">
      <!-- Force 3 columns with colgroup -->
      <colgroup>
        <col>
        <col>
        <col>
      </colgroup>

      <thead>
        <tr>
          <th>LANDFORM</th>
          <th>DOMINANT PROCESS</th>
          <th>AGENT OF FORMATION</th>
        </tr>
      </thead>
      <tbody>
        <!-- 12 rows built dynamically -->
      </tbody>
    </table>

    <button id="checkButton" class="btn">Check</button>
    <button id="retryButton" class="btn">Restart</button>
    <button id="copyButton" class="btn">Copy</button>
  </div>

  <!-- RIGHT: Banks of draggables -->
  <div id="banksContainer">
    <div class="bank" id="processBank">
      <h2>Dominant Processes</h2>
    </div>
    <div class="bank" id="agentBank">
      <h2>Agents of Formation</h2>
    </div>
  </div>
</div>

<script>
///////////////////////////////
// Data
///////////////////////////////
const landformsData = [
  { landform: "Butte",         process: "Erosional",    agent: "Aeolian"   },
  { landform: "Volcano",       process: "Tectonic",     agent: "Volcanic"  },
  { landform: "Flood Plain",   process: "Depositional", agent: "Fluvial"   },
  { landform: "Mesa",          process: "Erosional",    agent: "Aeolian"   },
  { landform: "Harbour",       process: "Erosional",    agent: "Coastal"   },
  { landform: "Delta",         process: "Depositional", agent: "Fluvial"   },
  { landform: "River",         process: "Erosional",    agent: "Fluvial"   },
  { landform: "Glacier",       process: "Erosional",    agent: "Glacial"   },
  { landform: "Mountain",      process: "Tectonic",     agent: "Orogenic"  },
  { landform: "Canyon",        process: "Erosional",    agent: "Fluvial"   },
  { landform: "Island Arch.",  process: "Tectonic",     agent: "Volcanic"  },
  { landform: "Beach",         process: "Depositional", agent: "Coastal"   }
];

const processes = ["Erosional","Tectonic","Depositional"];
const agents   = ["Aeolian","Volcanic","Fluvial","Coastal","Glacial","Orogenic"];

///////////////////////////////
// Build Table Rows
///////////////////////////////
const tbody = document.querySelector("#landformsTable tbody");
landformsData.forEach((obj, idx) => {
  const tr = document.createElement("tr");

  // 1) Landform cell (read-only)
  const tdLand = document.createElement("td");
  tdLand.textContent = obj.landform;
  tr.appendChild(tdLand);

  // 2) Dominant Process cell => single dropzone
  const tdProc = document.createElement("td");
  tdProc.classList.add("dropzone");
  tdProc.dataset.rowIndex = idx;
  tdProc.dataset.colType  = "process";
  tr.appendChild(tdProc);

  // 3) Agent of Formation cell => single dropzone
  const tdAgent = document.createElement("td");
  tdAgent.classList.add("dropzone");
  tdAgent.dataset.rowIndex = idx;
  tdAgent.dataset.colType  = "agent";
  tr.appendChild(tdAgent);

  tbody.appendChild(tr);
});

///////////////////////////////
// Build Bank Items
///////////////////////////////
const processBank = document.getElementById("processBank");
const agentBank   = document.getElementById("agentBank");

processes.forEach(proc => {
  let div = document.createElement("div");
  div.classList.add("draggable","process-item");
  div.setAttribute("draggable","true");
  div.textContent = proc;
  // On dragstart => we "clone" from bank
  div.addEventListener("dragstart", onBankItemDragStart);
  processBank.appendChild(div);
});

agents.forEach(a => {
  let div = document.createElement("div");
  div.classList.add("draggable","agent-item");
  div.setAttribute("draggable","true");
  div.textContent = a;
  div.addEventListener("dragstart", onBankItemDragStart);
  agentBank.appendChild(div);
});

///////////////////////////////
// Dropzones for each cell
///////////////////////////////
document.querySelectorAll(".dropzone").forEach(zone => {
  zone.addEventListener("dragover", onDropzoneDragOver);
  zone.addEventListener("dragleave", onDragLeave);
  zone.addEventListener("drop", onDropzoneDrop);
});

// Banks can accept occupant from cell
[processBank, agentBank].forEach(bank => {
  bank.addEventListener("dragover", (ev) => {
    ev.preventDefault();
    bank.classList.add("highlight");
    ev.dataTransfer.dropEffect = "move";
  });
  bank.addEventListener("dragleave", () => {
    bank.classList.remove("highlight");
  });
  bank.addEventListener("drop", (ev) => {
    ev.preventDefault();
    bank.classList.remove("highlight");

    let text     = ev.dataTransfer.getData("text/plain");
    let bankType = ev.dataTransfer.getData("bank-type");

    let newEl = document.createElement("div");
    newEl.classList.add("draggable");
    newEl.setAttribute("draggable","true");
    if (bankType === "process") newEl.classList.add("process-item");
    else newEl.classList.add("agent-item");

    newEl.textContent = text;
    newEl.addEventListener("dragstart", onBankItemDragStart);

    bank.appendChild(newEl);
  });
});

// Buttons
document.getElementById("checkButton").addEventListener("click", onCheck);
document.getElementById("retryButton").addEventListener("click", onRestart);
document.getElementById("copyButton").addEventListener("click", onCopy);

///////////////////////////////
// DRAG from Bank => clone approach
///////////////////////////////
function onBankItemDragStart(ev) {
  const text = ev.target.textContent;
  const isProc = ev.target.classList.contains("process-item");
  ev.dataTransfer.setData("text/plain", text);
  ev.dataTransfer.setData("bank-type", isProc ? "process" : "agent");
  ev.dataTransfer.effectAllowed = "copy";
}

///////////////////////////////
// DRAG from Cell => move occupant
///////////////////////////////
function onCellItemDragStart(ev) {
  const text = ev.target.textContent;
  const isProc = ev.target.classList.contains("process-item");
  ev.dataTransfer.setData("text/plain", text);
  ev.dataTransfer.setData("bank-type", isProc ? "process" : "agent");
  ev.dataTransfer.effectAllowed = "move";
}

function onDropzoneDragOver(ev) {
  ev.preventDefault();
  ev.currentTarget.classList.add("highlight");
  ev.dataTransfer.dropEffect = "copy";
}
function onDragLeave(ev) {
  ev.currentTarget.classList.remove("highlight");
}

function onDropzoneDrop(ev) {
  ev.preventDefault();
  ev.currentTarget.classList.remove("highlight");

  // If occupant present => remove it (only 1 occupant per cell)
  const occupant = ev.currentTarget.querySelector(".draggable");
  if (occupant) occupant.remove();

  const text     = ev.dataTransfer.getData("text/plain");
  const bankType = ev.dataTransfer.getData("bank-type");

  // Create new occupant
  let newEl = document.createElement("div");
  newEl.classList.add("draggable");
  newEl.setAttribute("draggable","true");
  if (bankType === "process") newEl.classList.add("process-item");
  else newEl.classList.add("agent-item");

  newEl.textContent = text;
  // so user can drag it from the cell to another place if needed
  newEl.addEventListener("dragstart", onCellItemDragStart);

  ev.currentTarget.appendChild(newEl);
}

///////////////////////////////
// CHECK LOGIC
///////////////////////////////
function onCheck() {
  // lock drags
  document.querySelectorAll(".draggable").forEach(d => {
    d.setAttribute("draggable","false");
  });
  // clear old correctness
  document.querySelectorAll(".draggable").forEach(d => {
    d.classList.remove("correct","incorrect");
  });

  let allCorrect = true;
  const rows = document.querySelectorAll("#landformsTable tbody tr");
  rows.forEach((tr, i) => {
    const correctProc  = landformsData[i].process;
    const correctAgent = landformsData[i].agent;

    const procCell  = tr.children[1];
    const agentCell = tr.children[2];

    let occupantP = procCell.querySelector(".draggable");
    if (!occupantP || occupantP.textContent !== correctProc) {
      if (occupantP) occupantP.classList.add("incorrect");
      allCorrect = false;
    } else {
      occupantP.classList.add("correct");
    }

    let occupantA = agentCell.querySelector(".draggable");
    if (!occupantA || occupantA.textContent !== correctAgent) {
      if (occupantA) occupantA.classList.add("incorrect");
      allCorrect = false;
    } else {
      occupantA.classList.add("correct");
    }
  });

  if (allCorrect) {
    document.getElementById("copyButton").style.display = "inline-block";
  } else {
    document.getElementById("copyButton").style.display = "none";
  }
}

///////////////////////////////
// RESTART
///////////////////////////////
function onRestart() {
  // Remove occupant clones from table cells
  document.querySelectorAll(".dropzone .draggable").forEach(d => d.remove());

  // re-enable bank items
  document.querySelectorAll(".draggable").forEach(d => {
    d.classList.remove("correct","incorrect");
    d.setAttribute("draggable","true");
  });
  document.getElementById("copyButton").style.display = "none";
}

///////////////////////////////
// COPY TABLE
///////////////////////////////
async function onCopy() {
  let text = "Landform\tDominant Process\tAgent of Formation\n";
  const rows = document.querySelectorAll("#landformsTable tbody tr");
  rows.forEach((tr, i) => {
    const land  = landformsData[i].landform;
    const proc  = tr.children[1].querySelector(".draggable")?.textContent || "";
    const agent = tr.children[2].querySelector(".draggable")?.textContent || "";
    text += `${land}\t${proc}\t${agent}\n`;
  });
  try {
    await navigator.clipboard.writeText(text);
    alert("Copied table to clipboard! You can now paste it into your notes.");
  } catch(e) {
    alert("Copy failed: " + e);
  }
}
</script>
</body>
</html>
